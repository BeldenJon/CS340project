{{!-- Just some plain text --}}
    <h1> Area 57 Construction</h1>
    <div id="navBar">
        <a href="./JobSites">Jobs</a> |
        <a href="./Tasks">Tasks</a> |
        <a href="./Contractors">Contractors</a> |
        <a href="./Trades">Trade</a> |
        <a href="./ContractorsTrades">Contractors Trades</a>
    </div>
    <h2>Tasks: tracks progression of each step of residential construction. Captures the
        task order, description, start/end dates, who the task is assigned to, completion percent and billing details.</h2>

{{!--jquery for delete operation--}}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

{{!-- The Data from our Database --}}

{{!-- Create a table --}}
<table id="Task-table">
    <thead>
        <tr>
            <th></th>
            {{#each data.[0]}}
            <th>
                {{@key}}
            </th>
            {{/each}}
            <th></th>
        </tr>
    </thead>

    {{!-- Body section --}}
    <tbody>
        {{!-- For each row, print the id, fname, lname, homeworld and age, in order --}}
        {{#each data}}
        <tr task-value={{this.TaskID}}>
            <td><a href="#" onClick="updateTask({{this.TaskID}})">Edit</a></td>
            <td>{{this.TaskID}}
            <td>{{this.JobSiteID}}</td>
            <td>{{this.Description}}</td>
            <td class="rightA">{{this.TaskSeq}}</td>
            <td>{{this.Start_Date}}</td>
            <td>{{this.End_Date}}</td>
            <td>{{this.ContractorTradeID}}</td>
            <td contr-trade={{this.ContractorTradeID}}>{{this.ContTrade}}</td>
            <td class="rightA">{{this.PercentComplete}}</td>
            <td class="rightA">{{this.CostEstimate}}</td>
            <td class="rightA">{{this.CostBilled}}</td>
            <td class="rightA">{{this.Due_Date}}</td>
            <td>{{this.Paid}}</td>
            <td><a href="#" onClick="deleteTaskAjax({{this.TaskID}})">Delete</a></td>
        </tr>
        {{/each}}
    </tbody>
</table>

<br>
<button onClick="showAddNew()">Add New</button><br><br>


{{!-- Form to add a record to the table using AJAX --}}
<form id="add-Task-form-ajax">
    <legend> Add New Task </legend>
    <fieldset class="fields">
        <label for="input-JobSite">Job Site: </label>
        <select name="input-JobSite" id="input-JobSite">
            <option value="">Select a Job Site:</option>
            {{#each jobs}}
                <option value="{{this.JobSiteID}}">{{this.JobAddress}}</option>
            {{/each}}
        </select><br>

        <label for="input-description">Task Description: </label>
        <input type="text" name="input-description" id="input-description" size="120"><br>

        <label for="input-sequence">Task Sequence: </label>
        <input type="number" name="input-sequence" id="input-sequence">

        <label for="input-startDate">Start Date: </label>
        <input type="date" name="input-startDate" id="input-startDate">

        <label for="input-endDate">End Date: </label>
        <input type="date" name="input-endDate" id="input-endDate"><br>

        <label for="input-contTrade">Contractor and Trade: </label>
        <select name="input-contTrade" id="input-contTrade">
            <option value="">Select a Contractor and Trade:</option>
            {{#each contrTrades}}
                <option value="{{this.ContractorTradeID}}">{{this.ContTrade}}</option>
            {{/each}}
        </select>

        <label for="input-percent">Percent Complete: </label>
        <input type="number" name="input-percent" id="input-percent"><br>
        
        <label for="input-Estimate">Task Estimate: </label>
        <input type="text" name="input-Estimate" id="input-Estimate">

        <label for="input-Billed">Task Billed: </label>
        <input type="text" name="input-Billed" id="input-Billed"><br>

        <label for="input-paymentDate">Payment Due Date: </label>
        <input type="date" name="input-paymentDate" id="input-paymentDate">

        <label for="input-paid">is Paid: </label>
        <input type="checkbox" name="input-paid" id="input-paid" class="largeCheckbox"><br>                

        <button class=btn type="submit" id="addTask" onClick="showTable()">Add New</button>
        <button class=btn type="button" value="cancel" onClick="showTable()">Cancel</button>
    </fieldset>
</form>

{{!-- Form to update a record to the table using AJAX --}}
<form id="update-Task-form-ajax">
    <legend> Update Task </legend>
    <fieldset>
        <label for="pass-TaskID">TaskID (readonly): </label>
        <input type="number" name="pass-TaskID" id="pass-TaskID" value="" readonly>

        <label for="update-JobSite">Job Site: </label>
        <select name="update-JobSite" id="update-JobSite">
            <option value="">Select a Job Site:</option>
            {{#each jobs}}
                <option value="{{this.JobSiteID}}">{{this.JobAddress}}</option>
            {{/each}}
        </select><br>

        <label for="update-description">Task Description: </label>
        <input type="text" name="update-description" id="update-description" size="120"><br>

        <label for="update-sequence">Task Sequence: </label>
        <input type="number" name="update-sequence" id="update-sequence">

        <label for="update-startDate">Start Date: </label>
        <input type="date" name="update-startDate" id="update-startDate">

        <label for="update-endDate">End Date: </label>
        <input type="date" name="update-endDate" id="update-endDate"><br>

        <label for="update-contTrade">Contractor and Trade: </label>
        <select name="update-contTrade" id="update-contTrade">
            <option value="">Select a Contractor and Trade:</option>
            {{#each contrTrades}}
                <option value="{{this.ContractorTradeID}}">{{this.ContTrade}}</option>
            {{/each}}
        </select>

        <label for="update-percent">Percent Complete: </label>
        <input type="number" name="update-percent" id="update-percent"><br>
        
        <label for="update-Estimate">Task Estimate: </label>
        <input type="text" name="update-Estimate" id="update-Estimate">

        <label for="update-Billed">Task Billed: </label>
        <input type="text" name="update-Billed" id="update-Billed"><br>

        <label for="update-paymentDate">Payment Due Date: </label>
        <input type="date" name="update-paymentDate" id="update-paymentDate">

        <label for="update-paid">is Paid: </label>
        <input type="checkbox" name="update-paid" id="update-paid" class="largeCheckbox"><br>

        <button class=btn type="submit" id="updatejob" onClick="showTable()">Update</button>
        <button class=btn type="button" value="cancel" onClick="showTable()">Cancel</button>
    </fieldset>
</form>


{{!-- Form to delete a record to the table using AJAX --}}
<form method="DELETE" id="delete-Task-ajax">
    <legend>Delete Task</legend>
    <fieldset>
        <label>Are you sure you would like to remove this task?</label>
    </fieldset>
    <button class=btn type="delete" id="deleteTask" onClick="deleteTask()">Yes Delete</button>
    <button class=btn type="button" value="cancel" onClick="showTable()">Cancel</button>
</form>

{{!--Set views--}}
    <script>
        function showTable() {
            document.getElementById("Task-table").style.display = "block";
            document.getElementById("add-Task-form-ajax").style.display = "none";
            document.getElementById("update-Task-form-ajax").style.display = "none";
            document.getElementById("delete-Task-ajax").style.display = "none";
        }
        //default show table on load
        showTable()
    </script>


{{!-- Embed our javascript to handle the DOM manipulation and AJAX request --}}
<script src="./js/add_Task.js"></script>
<script src="./js/update_Task.js"></script>
<script src="./js/delete_Task.js"></script>